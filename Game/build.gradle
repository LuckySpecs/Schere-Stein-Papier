apply plugin: "maven"
apply plugin: "java"


version = 0.1

configurations {  xjc  }

tasks.withType(JavaCompile) {
	options.encoding = 'cp1252'
}

sourceSets {
	main {
		java { srcDirs 'src/main/java' }
		resources {
			srcDirs "resources"
		}
	}
	test {
		java { srcDirs = ["src/test/java"]}
	}
}

repositories {
	mavenCentral()
	jcenter()
}

task viewerJar(type: Jar, dependsOn:classes) {
	from sourceSets.main.output
	doFirst{
		manifest {
			attributes("Built-By": ""+getUserName(),
			"Build-Date": ""+getDate(),
			"Build-Number": ""+version,
			"Main-Class": 'lucky.specs.games.roshambo.Application',
			"Class-Path": configurations.compile.collect({ it.name }).join(' ') )
		}
	}
}

def getDate() {
	Date date = new Date()
	def formattedDate = date.format('dd.MM.yyyy')
	println formattedDate
	println System.getenv("USERNAME")
	return formattedDate
}

def getUserName() {
	String username =  System.getenv("USERNAME")
	if(username == null) {
		return "BuildUser"
	}
	return username;
}
